---
layout: post
title: "インターフェイス指向設計 アジャイル手法によるオブジェクト指向設計の実践"
date: 2008-07-05 10:40
comments: true
categories: [System]
keywords: "インターフェース,interface,アジャイル,オブジェクト指向,凝集度,978-4-87311-366-1"
tags: [これは読むべき,インターフェース設計,オブジェクト指向,良書]
author: hamasyou
amazon_url: "http://www.amazon.co.jp/gp/product/4873113660/250-9582265-5494630?ie=UTF8&tag=sorehabooks-22&linkCode=xm2&camp=247&creativeASIN=4873113660"
amazon_author: "Ken Pugh (著), 角谷 信太郎(監訳) (翻訳), 児島 修 (翻訳)"
amazon_image: "http://ec2.images-amazon.com/images/I/51b8oJcFWdL._BO2,204,203,200_PIsitb-sticker-arrow-click,-76_AA300_SH20_OU09_.jpg"
amazon_publisher: "オライリージャパン"
---

本書は、プログラムにおけるインターフェース設計へアドバイスを与えるものです。GUIやデザインの話ではありません。高凝集度で疎結合な設計を行うためにインタフェース設計をどのように進めたらよいか、どのように考えてインターフェースを作れば良いかなどを説明しています。

システム開発というのは複雑な作業です。その複雑さを少しでも解消するために<strong>分割して統治せよ（Divide and Conquer）</strong>という理論を用いることが良いことだとされています。このときに大切になってくるのが「<strong>凝集度</strong>」と「<strong>結合度</strong>」になります。

凝集度は高いほど良い、つまり責任範囲が明確でが軸ぶれないほどよいです。結合度は低いほど、つまりそっちはそっちで勝手にやっててねとできるほどよいです。高凝集で低結合（英語で言うと「High Cohesion and Low Coupling!」）なプログラム部品にするために必要なのが「<strong>良いインターフェース</strong>」なのです。本書は、この良いインターフェースとは何か？どうやって良いインターフェースを設計するか？を解説するものです。

本書の対象読者は、プログラム経験があり設計に興味がある人、DI（Dependency Injection）って流行ってたけど未だに何が良いのかわからない人、テスト容易性が大事って聞くけどどうやって設計したらいいかわからない人です。

200ページくらいしかなく、かなり薄い本になっていますのでサクサク読めると思いますが、実はあまり詳しい説明というのが載っていません。内容が薄いのではなく、説明が薄いのです。「こんな場合こういう考えでインターフェースを切ると良いよ。作り方は二種類ある。長所はこれで、短所はこれ」みたいな説明が多いように思えました。

それでもかなりの良書の部類に入ると思います。さらっと読んで、良く理解できなかった部分は先輩に聞いたり、Webで質問したりして、自分なりに噛み砕いていく。そういう読み方をする本かなと思います。


<!-- more -->

<h2>本書に出てくるキーワード</h2>

<h3>インターフェイスの三原則</h3>

<ol>
<li>インターフェイス実装は、そのメソッド名が示す通りの処理をしなければならない</li>
<li>インターフェイス実装は他に危害を加えてはならない</li>
<li>インターフェイス実装は、責務を果たせない場合にそれを呼び出し元に伝えねばならない</li>
</ol>

つまり、「名前どおりの処理をし」、「後始末は自分でする、自分がエラーでも他に迷惑をかけない」、「自分で処理できないときは、呼び出し元に誤りをいれる」ということ。

<h3>契約（Contract）、契約による設計（Design By Contract）</h3>

インターフェイスの呼び出し元とインターフェイスとの間で交わされる約束のこと。事前条件、事後条件、不変表明の3つからなる。

<strong>事前条件</strong>はインターフェイスの呼び出し元が守らなければならない条件で、事前条件を満たない状態でインターフェイスを呼び出すと正しく動作しない。

<strong>事後条件</strong>はインターフェイスが守らなければならない条件で、事前条件を満たした状態で呼び出しが行われた場合に満たさなければならないもの。事後条件を満たせない場合は Java であれば例外をスローしたりする（原則3）

<strong>不変表明</strong>はインターフェイスのインスタンスが満たさなければいけない内部状態を表すもの。

<h3>データインターフェイスとサービスインターフェイス</h3>

データインターフェイスとは、属性の設定や取得のメソッドで構成されるインターフェイスのこと。JavaBeans などが該当する。

サービスインターフェイスとは、処理を行うメソッドで構成されるインターフェイスのこと。よくある3階層アーキテクチャのサービス層を司るものや、GUIのボタン押下で呼び出されるメソッドなどを持つもの。

<h3>エンティティ、バウンダリ、コントロール</h3>

<strong>エンティティ</strong>は、データインターフェイスに相当する。

<strong>バウンダリ</strong>は、サービスインターフェイスに相当する。主に GUI やユーザインターフェイスとして動作する種類のサービスインターフェイス。

<strong>コントロール</strong>も、サービスインターフェイスに相当する。主にビジネスロジックやビジネスルール、サービスを処理する種類のサービスインターフェイス。

<h3>ステートフルインターフェイスとステートレスインターフェイス</h3>

インターフェイスも状態を持つことができる。

<strong>ステートフルインターフェイス</strong>は、メソッドの呼び出しに順序があり、呼び出し順で状態が変わるもの。

<strong>ステートレスインターフェイス</strong>は、メソッドの呼び出しに順序がなく振る舞いが変わらないもの。

<h3>凝集度</h3>

責務の似具合のこと。共通のコンセプトに基づいたメソッドばかりで構成されたインターフェイスは凝集度が高いといえる。

<h3>結合度</h3>

相手がいないと動作できない具合のこと。相手のモジュールの処理に依存していない場合には結合度が低いといえる。

<h3>継承とインターフェイス</h3>

継承は機能の連鎖。is_a （である）や is_kind_of （の一種である） で表されることが多い。共通の処理や属性をまとめる際に使える。

インターフェイスはロールの連鎖。インターフェイスの継承は provides-a （提供する）で表されることが多い。

（適当に書いてみたけど、説明が難しいというか感覚的な感じなので、本書を読んでください。。。）

<h3>手続き型インターフェイスとドキュメント型インターフェイス</h3>

リモートインターフェイスとしてのインターフェイスを考える際の種類。

<strong>手続き型インターフェイス</strong>は、メソッドの処理を定義するタイプのインターフェイス。CORBA や RMI なんかがそれ。

<strong>ドキュメント型インターフェイス</strong>は、データメッセージをやり取りするタイプのインターフェイス。JSON や XML なんかがこれに当たる。

<h2>感想</h2>

良書だと思いました。ただし、インターフェイスってこういうものだっていう考えがある人が読まないと、頭が混乱してくる気がしました。それは、インターフェイスという言葉がいろいろな意味で使われているからです。Java のインターフェイスを表していることもあれば、相手とのやり取りそのものをインターフェイスといったり、メソッド定義もインターフェイス定義だよねというような、広い意味でインターフェイスといったりと。

インターフェイス設計の総おさらいのような感じで読むこともできるし、おお！こんな考え方があったのか！という新しい発見もあるしという感じです。

<h3>本書には書いてなかった気がするもの</h3>

<h4>インターフェイスの定義は呼び出し元がするべし！</h4>

これは私の持論（？）ですが、インターフェイスの定義というものは、使う側が指定するべきだと思っています。哲学とか入ってきてしまいますが、「自分が今ここにいるのは、他人がそう認識しているから」というイメージです。

「[ target="_blank" class="extlink">依存関係逆転の法則](http://blog.goo.ne.jp/glass-_-onion/e/91d51585d966f1a005f957eacacc01de)」的な考え方ともいえると思います。

<dl>
<dt class="tips">Tips</dt>
<dd>「<strong>インターフェイスが変わるときは、ユーザの要求が変わったときである。</strong>」</dd> 
</dl>

<h2>参考</h2>

<div class="rakuten">
<table  width="400" border="0" cellpadding="5"><tr><td colspan="2">[ target="_blank">アジャイルソフトウェア開発の奥義 第2版 オブジェクト指向開発の神髄と匠の技](http://www.amazon.co.jp/exec/obidos/ASIN/4797347783/sorehabooks-22/ref=nosim/)</td></tr><tr><td valign="top">[ target="_blank"><img src="http://ecx.images-amazon.com/images/I/51oH3DfWY4L._SL160_.jpg" border="0" alt="アジャイルソフトウェア開発の奥義 第2版 オブジェクト指向開発の神髄と匠の技" />](http://www.amazon.co.jp/exec/obidos/ASIN/4797347783/sorehabooks-22/ref=nosim/)</td><td valign="top"><font size="-1">瀬谷 啓介 <br /><br /><br />[ target="_blank">Amazonで詳しく見る](http://www.amazon.co.jp/exec/obidos/ASIN/4797347783/sorehabooks-22/ref=nosim/)</font><font size="-2"> by [ >G-Tools](http://www.goodpic.com/mt/aws/index.html)</font></td></tr></table>
</div>

<div class="rakuten">
<table width="400" border="0" cellpadding="5"><tr><td colspan="2">[ target="_blank">達人プログラマー―システム開発の職人から名匠への道](http://www.amazon.co.jp/exec/obidos/ASIN/4894712741/sorehabooks-22/ref=nosim/)</td></tr><tr><td valign="top">[ target="_blank"><img src="http://ecx.images-amazon.com/images/I/41HTQ8ZP3AL._SL160_.jpg" border="0" alt="達人プログラマー―システム開発の職人から名匠への道" />](http://www.amazon.co.jp/exec/obidos/ASIN/4894712741/sorehabooks-22/ref=nosim/)</td><td valign="top"><font size="-1">Andrew Hunt David Thomas 村上 雅章 <br /><br /><strong>おすすめ平均</strong> <img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" /><br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />素人から玄人への道<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />知らないと恥ずかしい<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="stars" />新人プログラマに読ませたい<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-5-0.gif" alt="stars" />初級PGから上級PGになるための本<br /><img src="http://g-images.amazon.com/images/G/01/detail/stars-4-0.gif" alt="stars" />SEの基本が書かれてます<br /><br />[ target="_blank">Amazonで詳しく見る](http://www.amazon.co.jp/exec/obidos/ASIN/4894712741/sorehabooks-22/ref=nosim/)</font><font size="-2"> by [ >G-Tools](http://www.goodpic.com/mt/aws/index.html)</font></td></tr></table>
</div>




